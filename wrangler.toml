name = "chariot-moon"
main = "apps/worker-main/index.ts"
compatibility_date = "2025-10-26"

[[d1_databases]]
binding = "DB"
database_id = "b0f69898-a140-4a79-88c0-33efb3289995"
migrations_dir = "apps/worker-main/migrations"

[[kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "6d5ec5ae4b264913b5c7d99df5059bd6"

[[kv_namespaces]]
binding = "AI_CONTROL_KV"
id = "a1d4ecc101cb4766a8737f9dac54b434"


[[kv_namespaces]]
binding = "ADMIN_EXPORT_LOG"
id = "48757921d979411b8c8feaee95fb8006"

[[kv_namespaces]]
binding = "ADMIN_TG_IDS"
id = "4278f1dae3eb4b1ca1d4fc08a7974b0e"

[[kv_namespaces]]
binding = "BROADCAST_PENDING_KV"
id = "b78e9b7a28c34543b662ec0b4a8bf4b7"

[[kv_namespaces]]
binding = "BROADCAST_TELEMETRY_KV"
# Рекурсируем привязку к тому же namespace, что и BROADCAST_PENDING_KV,
# чтобы не заводить отдельное KV и использовать уже существующий namespace,
# пригодный для телеметрии и pending-очереди.
id = "b78e9b7a28c34543b662ec0b4a8bf4b7"

[vars]
# Wrangler keeps plaintext variables defined here in sync on every deploy. Sensitive
# values are managed as secrets (see `scripts/bootstrap-cloudflare-secrets.sh`). D1 и KV
# уже привязаны через блоки [[d1_databases]]/[[kv_namespaces]] выше.
CONFIG_REQUIRED_SECRETS = "OPENAI_API_KEY,OPENAI_MODEL,OPENAI_PROMPT_ID,OPENAI_PROMPT_VARIABLES,TELEGRAM_BOT_TOKEN,TELEGRAM_WEBHOOK_SECRET,ADMIN_TOKEN"
STRESS_TEST_ENABLED = "0"
