===== BEGIN FILE: Protocol.md =====

Базовый протокол для агента без межзадачной памяти.  
  
Назначение: создать и вести `RoadMap` и `MemoryBank` как операционную систему управления проектом, планировать надёжно, сверяться с архитектурой, видя единую картину всей системы «с высоты птичьего полета» как связь полностью согласованных элементов. Выполнять задачи надежными шагами, которые не перегрузят и легко проверить, но не слишком маленькими, чтобы двигаться быстрее без избыточных согласований. Создать возможность параллельного выполнения задач разными агентами без возникновения конфликтов при мердже.

1) Инициализация (выполнить один раз сразу): Создай файл `RoadMap.md` и папку `memory-bank/` (если их нет).  
  
2) Заполни `RoadMap.md` по шаблону:  

- Общую задачу разбей на подзадачи (если она слишком большая, то на майлстоуны, каждый из которых может быть разбит на подзадачи перед началом его выполнения).
- Определи, как ты поймешь, что майлстоун выполнен. Максимально четкие критерии проверки.
- Убедись, что ты выбрал максимально эффективный путь. Проверь его на возможные системные риски: ошибки, уязвимости, конфликты, несогласованность, узкие места. Скорректируй или дополни, чтобы получить максимальную надежность, стабильность и эффективность системы (без перегрузов, перерасходов, лишних действий).
- Проверь ещё раз после коррекции, что она не привела к новым потенциальным проблемам или неэффективностям. И если это произошло, то скорректируй снова, пока не получишь идеальный план решения задачи.
- Выполняй это действие перед выполнением каждой задачи, которую нужно разбить на элементы, шаги или подзадачи. А также после коррекции уже существующих элементов. Требуемые измненения добавь в шаги текущего майлстона или всей дорожной карты, если это большие изменения.
3) Используй `memory-bank/` для сохранения в него опорной информации, которая может понадобится тебе в будущем. Все документы, оргаенизующие процесс и не относящиеся к коду храни в memory-bank (например, diff-limits, если ты обнаружишь, что существует «потолок» размера задачи или «слепки» данных по изменяемым файлам для будущих сверок и т.д.) Зафиксируй, что логи и baseline-файлы лежат в `logs/` и `snapshot/`, а в git хранятся только `.gitkeep`.

4) Вноси оперативные изменения в RoadMap по факту выполнения задач, добавления новых, коррекции пути, общей картины системы. RoadMap источник истины. Команда «Следуй дорожной карте» запускает рабочий процесс по RoadMap и при выходе на шаги проверок переводит исполнителя к разделу «Протокол проверки», обязательному к исполнению.

5) Перед каждой задачей сверяйся с общей картиной всей системы, видя её как связь ключевых элементов. Чтобы сохранять её стабильность и согласованность, исключать конфликты, узкие места и неэффективности. Если такие обнаружены, то сообщи об этом и предложи корректировку.

6) Не плоди лишних сущностей без надобности - стремись держать систему простой, элегантной и эффективной. Не срезай углы и делай всё так, как правильно для надежной работы.  
  
  7) Рабочий цикл:
     - Перед каждой партией: проверить актуальную ветку, свериться с дорожной картой, выбрать памятки, составить микро-план, выполнять партии \<≈150 файлов, после каждой партии запускать скрипты проверок, ручной просмотр, сохранять логи, контролировать `git diff --stat`, фиксировать прогресс в дорожной карте и журнале diff.
     - Когда RoadMap доводит до шага проверок, переключайся на раздел «Протокол проверки», выполняй его полностью и фиксируй результаты и задачи-исправления перед возвратом к RoadMap.
     - Каждый подпункт дорожной карты должен завершаться отдельным коммитом, после завершения — обновление roadmap, памяток и журнала.

  8) Завершающий ритуал:
     - В конце каждой сессии описывать выполненные действия, пройденные проверки, следующую цель, и напоминать о необходимости push/PR.
     - Контролировать, что ветка не расходится и коммиты идут линейно в рамках одной дорожной карты.
     - Проверять, что задачи-исправления и ретесты из раздела «Протокол проверки» заведены, обновлены статусами и закрыты перед переходом к следующему шагу RoadMap.
9) Поддерживай операционную систему «protocol -\> roadmap + memory-bank». При старте сессии убедись, что создано три опорных артефакта: `RoadMap.md` как единственный источник истины, а также каталог `memory-bank/` с командами и чек-листами. В дорожной карте (`RoadMap.md `) фиксируй контекст, цели, декомпозицию задач, принципы работы (минимальные партии, двойная проверка, точки отката, контроль диффов, хранение артефактов вне git), риски, журнал прогресса, текущее состояние и быстрый протокол с кодами шагов. В инструкции поддерживай детальные действия для повторяющихся этапов и правила общего режима. В `memory-bank/` собирай памятки и всё что может понадобится для сверки или сохранения информации о системе, её истории и устройстве на будущих шагах.

10) Определи эффективную последовательность выполнения задачи для каждого проекта исходя из созданной операционной системы репозитория (например: «Протокол, шаг \<код шага/этапа\>»), запиши её в Дорожную карту и следуй этой последовательности. Просматривай актуальные записи в `memory-bank/`, затем уточняй план и фиксируй выполнение шагов в `RoadMap.md`. При необходимости указывай конкретный код шага, чтобы сразу перейти к нужному сценарию.  
  
11) Используй этот протокол (`Protocol.md`) как основу для создания или адаптации операционной системы под новый проект (репозиторий), сохраняя структуру документов, процедур и правил. Все изменения по системе проекта и управлению его ходом вноси в RoadMap.md. Protocol.md используй как фундаментальный и основоопределяющий документ. В него вноси изменения только если пользователь тебя об этом попросит и добавляй их следующими пунктами, не меняя уже созданные.
12) Если в задаче появляются неизвестные элементы, обновлённые сервисы или неясные интеграции, сначала задай все необходимые вопросы и получи подтверждение, чтобы исключить предположения перед разработкой.
13) Отчет о выполнении задачи всегда предоставляй на русском языке, визуализируй прогресс выполнения через оценочный прогресс-бар с указанием процента пройденного пути, указывай цель ближайшего майлстоуна и количество задач до него согласно дорожной карте. Если требуется участие внешней команды для подключения внешних модулей или внешней проверки, не совпадающей с майлстоунами, также фиксируй количество задач, оставшихся до такого события.

14) Перед переключением на новый майлстоун выполняй gate-чек линейности дорожной карты:
    - Запусти `npm run check:roadmap` и убедись, что скрипт завершается без ошибок.
    - Ручной проверкой подтверди, что предыдущий майлстоун не содержит статусов `⏳` или `🚧`; при выявлении таких статусов заводи «Задачу-торможение» и не переходи дальше.
    - Результат фиксации заноси в журнал прогресса и при необходимости синхронизируй с памяткой `memory-bank/follow-roadmap.md`.
