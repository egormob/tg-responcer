# M9 AI/export interplay ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (26.11.2025)

## –¶–µ–ª—å
–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∞–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã (`/export`, `/admin status`, `/admin access`) –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –º–µ—à–∞—é—Ç –æ—á–µ—Ä–µ–¥–∏ OpenAI, –∞ fallback `‚ö†Ô∏è ‚Üí üîÅüí¨` —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π `queueDetails`.

## –ó–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | –ß—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç |
| --- | --- |
| [`memory-bank/logs/wrangler-admin-export-rate-limit-2025-11-25.log`](wrangler-admin-export-rate-limit-2025-11-25.log) | –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ `/export` –ø–æ–ø–∞–¥–∞—é—Ç –≤ `rawRateLimit`, —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è 429 –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ —è–¥—Ä–∞. |
| [`memory-bank/logs/rate-limit-kv-2025-11-26.md`](rate-limit-kv-2025-11-26.md) | –†—É—á–Ω–æ–µ —Å–Ω—è—Ç–∏–µ –∫—É–ª–¥–∞—É–Ω–∞ `admin_export` –ø–æ–∫–∞–∑–∞–ª–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª—é—á–µ–π –∏ TTL ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å KV. |
| [`memory-bank/logs/telegram-admin-recovery-2025-11-26.md`](telegram-admin-recovery-2025-11-26.md) | –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –∫—É–ª–¥–∞—É–Ω–∞ `/admin` —Å–Ω–æ–≤–∞ –æ—Ç–≤–µ—á–∞–µ—Ç whitelisted –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫. |
| [`memory-bank/logs/wrangler-tail-admin-2025-11-26.md`](wrangler-tail-admin-2025-11-26.md) | `wrangler tail` —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç `/admin`, `/admin status` –∏ `/admin access`: –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è `HTTP 200`, `aiQueue.active=0`, `queued=0`. |
| [`memory-bank/logs/ai-queue-smoke-2025-11-16.md`](ai-queue-smoke-2025-11-16.md) | Smoke-–ø—Ä–æ–≥–æ–Ω Variant‚ÄØC: `AI_QUEUE_TIMEOUT` –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, `sources.* = "kv"`, `droppedSinceBoot=0` –Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–µ `STRESS_TEST_ENABLED=1`. |
| [`reports/REPORT-ai-throughput-20251116.md`](../../reports/REPORT-ai-throughput-20251116.md) | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Variant‚ÄØC (`requestTimeoutMs=18000`, `retryMax=3`) –∏ —Ñ–æ—Ä–º–∞—Ç `queueDetails`, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —Å—Å—ã–ª–∞—é—Ç—Å—è tail-–ª–æ–≥–∏. |

## –•–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏
1. **26.11.2025 08:41 UTC** ‚Äî –∏–Ω—Å–ø–µ–∫—Ü–∏—è –∫–ª—é—á–∞ `rate_limit:scope:admin_export:*` (—Å–º. `rate-limit-kv-2025-11-26.md`). –ü–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏, —á—Ç–æ –∫—É–ª–¥–∞—É–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ –ø–æ chat/user –∏ —É–¥–∞–ª—è—é—Ç—Å—è —Ç–æ—á–µ—á–Ω–æ.
2. **25.11.2025 09:15 UTC** ‚Äî `wrangler-admin-export-rate-limit-2025-11-25.log` –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª –¥–≤–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö `/export`, –ø–æ–ª—É—á–∏–≤—à–∏—Ö 429 –∏ –Ω–µ –ø–æ–ø–∞–≤—à–∏—Ö –≤ —è–¥—Ä–æ: `router` –∑–∞–≤–µ—Ä—à–∏–ª –∑–∞–ø—Ä–æ—Å –¥–æ –≤—ã–∑–æ–≤–∞ `DialogEngine`, –∑–Ω–∞—á–∏—Ç –æ—á–µ—Ä–µ–¥—å AI –æ—Å—Ç–∞–ª–∞—Å—å —Å–≤–æ–±–æ–¥–Ω–æ–π.
3. **26.11.2025 08:44‚Äì08:46 UTC** ‚Äî `wrangler tail` (—Ñ–∞–π–ª `wrangler-tail-admin-2025-11-26.md`) –ø–æ–∫–∞–∑–∞–ª `/admin`, `/admin status`, `/admin access` c `aiQueue: active 0 / queued 0` –ø—Ä—è–º–æ –≤ –æ—Ç–≤–µ—Ç–µ `/admin status`. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –¥–∞–∂–µ –ø–æ—Å–ª–µ —Å–Ω—è—Ç–∏—è –∫—É–ª–¥–∞—É–Ω–∞ –æ—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞.
4. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ** ‚Äî –≤ `telegram-admin-recovery-2025-11-26.md` —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Å–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–µ –∞–¥–º–∏–Ω–∞: `/admin`, `/admin status`, `/admin export` –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π ping. –û–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç tail-–ª–æ–≥—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π.
5. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –¥–∏–∞–ª–æ–≥–æ–º** ‚Äî `ai-queue-smoke-2025-11-16.md` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π `STRESS_TEST_ENABLED=1`, –≥–¥–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —à–ª–∏ –æ–±—ã—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∞–¥–º–∏–Ω—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è. –õ–æ–≥ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç `droppedSinceBoot=0`, `active‚â§1` –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `AI_QUEUE_TIMEOUT` —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è; fallback ¬´‚ö†Ô∏è ‚Üí üîÅüí¨¬ª —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–ª—Å—è `[ai][timeout] queueDetails={ ... }` (—Å–º. –æ—Ç—á—ë—Ç 16.11).

## –í—ã–≤–æ–¥
–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ:
- `/export` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è `rawRateLimit` –∏ –æ—á–∏—â–∞–µ–º—ã–º KV-–∫—É–ª–¥–∞—É–Ω–æ–º, –ø–æ—ç—Ç–æ–º—É –Ω–µ —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å AI.
- –ü–æ—Å–ª–µ —Å–Ω—è—Ç–∏—è –∫—É–ª–¥–∞—É–Ω–∞ whitelisted –∞–¥–º–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –æ—á–µ—Ä–µ–¥–∏ (`aiQueue active=0/queued=0`).
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∏–∞–ª–æ–≥–∏ –≤–æ –≤—Ä–µ–º—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥ –Ω–µ –ø–æ–ª—É—á–∞—é—Ç `AI_QUEUE_TIMEOUT`; –µ—Å–ª–∏ OpenAI –æ—Ç–≤–µ—á–∞–µ—Ç —Å —Ç–∞–π–º–∞—É—Ç–æ–º, `DialogEngine` –ª–æ–≥–∏—Ä—É–µ—Ç `queueDetails` (—Ñ–æ—Ä–º–∞—Ç Variant‚ÄØC).

–°—Ü–µ–Ω–∞—Ä–∏–π `m9-ai-export-timeout` —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–º: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–æ–ª–µ–π, –ª–∏–º–∏—Ç–æ–≤ –∏ AI-–æ—á–µ—Ä–µ–¥–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞, –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ. –°–ª–µ–¥—É—é—â–∏–µ —Ä–µ—Ç–µ—Å—Ç—ã –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ —Ç–æ–π –∂–µ –ø—Ä–æ—Ü–µ–¥—É—Ä–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤.
