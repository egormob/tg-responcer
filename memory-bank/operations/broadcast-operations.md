# Broadcast Operations Guide

## –ö–æ–Ω—Ç—É—Ä –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ä–∞—Å—Å—ã–ª–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Telegram-–∫–æ–º–∞–Ω–¥—É `/broadcast` –≤–Ω—É—Ç—Ä–∏ –≤–æ—Ä–∫–µ—Ä–∞.
- –ö–æ–º–∞–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ whitelisted –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –∏–∑ –±–∏–Ω–¥–∏–Ω–≥–∞ `ADMIN_TG_IDS`.
- –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π Telegram-–∞–¥–∞–ø—Ç–µ—Ä. –õ—é–±–æ–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä (Telegram-–∫–æ–º–∞–Ω–¥–∞ –∏–ª–∏ HTTP-—Ä–æ—É—Ç) –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É –∏ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –≤ —Ñ–æ–Ω–æ–≤—É—é –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ `waitUntil`. –û—á–µ—Ä–µ–¥–∏, scheduler –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-—Å—Ç–æ—Ä —É–¥–∞–ª–µ–Ω—ã.

## –§–ª–∞–≥–∏ –∏ —Ç–æ–∫–µ–Ω—ã
- `TELEGRAM_BOT_TOKEN` ‚Äî –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
- `ADMIN_TG_IDS` ‚Äî KV-namespace —Å whitelisted Telegram ID (`{"whitelist":["123","456"]}` –∏–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç). –¢–æ–ª—å–∫–æ —ç—Ç–∏ ID –º–æ–≥—É—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π —Ä–∞—Å—Å—ã–ª–∫–∏.
- `BROADCAST_ENABLED` (–µ—Å–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∏–≤–µ–¥—ë–Ω –∫ –∑–Ω–∞—á–µ–Ω–∏—é ¬´1¬ª/`true`, —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥–∞ –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞.

## –°—Ü–µ–Ω–∞—Ä–∏–π `/broadcast`
1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/broadcast` –±–æ—Ç—É –≤ –ª–∏—á–Ω–æ–º —á–∞—Ç–µ.
2. –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫–æ–π ¬´–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Ä–∞—Å—Å—ã–ª–∫–∏¬ª –∏ –æ–∂–∏–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Ç–æ–≥–æ –∂–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
3. –ü–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–µ–ø—É—Å—Ç–æ–π –∏ ‚â§4096 —Å–∏–º–≤–æ–ª–æ–≤) –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤—Å–µ–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ —Ä–∞—Å—Å—ã–ª–æ–∫. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ: Worker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `waitUntil`, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å HTTP-–æ—Ç–≤–µ—Ç.
4. –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –±–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Ç–æ–≤, –∫—É–¥–∞ —É—à–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –î–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –¥–æ 4096 —Å–∏–º–≤–æ–ª–æ–≤. –ë–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é.
- –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏: –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ ‚â§28 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ (–∂—ë—Å—Ç–∫–∏–π –ø—Ä–µ–¥–µ–ª ‚âà30/—Å–µ–∫) –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ–º–ø —Ä–∞—Å—Å—ã–ª–∫–∏.
- –ù–∞ –∫–∞–∂–¥—ã–π —á–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–µ –±–æ–ª–µ–µ 1 —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥—É; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–∞—Å—Ç—è–≥–∏–≤–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É –ø–æ –≤—Ä–µ–º–µ–Ω–∏.
- –†–∞–∑–º–µ—Ä –≤–ª–æ–∂–µ–Ω–∏–π (–¥–æ–∫—É–º–µ–Ω—Ç—ã, –º–µ–¥–∏–∞) ‚Äî –¥–æ 50‚ÄØ–ú–ë; –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏.
- –ö–æ–º–∞–Ω–¥–∞ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–Ω–µ whitelist: –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç `forbidden`/`access denied` –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç.
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `/broadcast` —Ç—Ä–µ–±—É–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã –∏ —Ç–µ–∫—Å—Ç–∞; –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–µ–π –Ω–µ—Ç.

## –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç
1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `ADMIN_TG_IDS` —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.
   - –í—ã–ø–æ–ª–Ω–∏—Ç—å `GET /admin/access` —Å –≤–∞–ª–∏–¥–Ω—ã–º `x-admin-token`, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ whitelisted ID –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤ `whitelist`, –∞ `health` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `status: "ok"` –∏–ª–∏ –æ–±—ä—è—Å–Ω–∏–º—ã–µ –∫–æ–¥—ã –æ—à–∏–±–æ–∫ Telegram.
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å `TELEGRAM_BOT_TOKEN`.
   - (–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è) –≤—ã—Å—Ç–∞–≤–∏—Ç—å `BROADCAST_ENABLED=1` –≤ KV.
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è**
   - –û—Ç whitelisted –∞–∫–∫–∞—É–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `/broadcast` ‚Üí –≤–≤–µ—Å—Ç–∏ –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´ping¬ª). –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —á–∞—Ç–∞—Ö.
   - –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É —Å –Ω–µ-whitelisted –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –±–æ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç –±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏.
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: –ø—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç, —Ç–µ–∫—Å—Ç –∏–∑ 4096 —Å–∏–º–≤–æ–ª–æ–≤.
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –°–º–æ—Ç—Ä–µ—Ç—å `wrangler tail` –≤–æ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏; –æ—à–∏–±–∫–∏ Telegram –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Ç–µ–≥–æ–º `[broadcast]`.
   - –ü–æ—Å–ª–µ —Ä–∞—Å—Å—ã–ª–∫–∏ –∑–∞–ø–∏—Å–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –∂—É—Ä–Ω–∞–ª (–¥–∞—Ç–∞, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π).

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—é
- –ö–∞–∂–¥–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ –∂—É—Ä–Ω–∞–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `memory-bank/stable-builds.md` –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ–º operational log) —Å –¥–∞—Ç–æ–π, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –∏ –∫—Ä–∞—Ç–∫–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º —Å–æ–æ–±—â–µ–Ω–∏—è.
- –ü—Ä–∏ —Å–±–æ—è—Ö —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –ª–æ–≥–æ–≤ `wrangler tail` –∏ –æ–ø–∏—Å–∞—Ç—å —à–∞–≥–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è. –ü—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ `waitUntil` –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ –∏ –æ—Ç–¥–∞—é—Ç –æ–∂–∏–¥–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏.

## waitUntil –∏ —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- HTTP-—Ä–æ—É—Ç `/admin/broadcast` –∏ Telegram-–∫–æ–º–∞–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ sender. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å—Ä–∞–∑—É –æ—Ç–≤–µ—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É (`202 Accepted`) –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —á–µ—Ä–µ–∑ `waitUntil`, —á—Ç–æ–±—ã —Å–æ–æ–±—â–µ–Ω–∏—è —É—à–ª–∏ –¥–∞–∂–µ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞–ø—Ä–æ—Å–∞.
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä—É—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `wrangler tail` –∏ –∏—â–∏—Ç–µ –∑–∞–ø–∏—Å–∏ `admin broadcast delivered` / `admin broadcast failed`.
- –ï—Å–ª–∏ `waitUntil` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ unit-—Ç–µ—Å—Ç–∞—Ö), –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å—ë —Ä–∞–≤–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç sender, –Ω–æ –ª–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ ‚Äî –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —ç—Ç–æ —Å–∏–≥–Ω–∞–ª –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–∞.

## –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
- **–õ–æ–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–¥–∞—á–∏ 6. üì£ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏.** –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø—Ä–æ–≥–æ–Ω–æ–≤ HTTP –∏ broadcast suite:

```bash
cd ~/Projects/tg-responcer
export WORKER_BASE_URL="https://tg-responcer.egormob.workers.dev"
export ADMIN_TOKEN="devadmintoken"

ts="$(date +%Y%m%d-%H%M%S)"
mkdir -p logs reports

set -u -o pipefail

CI=1 npm run test -- http | tee "logs/test-http-$ts.log" >/dev/null
http_exit="${PIPESTATUS[0]}"
zip -j "logs/test-http-latest.zip" "logs/test-http-$ts.log" >/dev/null

CI=1 npm run test -- broadcast | tee "logs/test-broadcast-$ts.log" >/dev/null
br_exit="${PIPESTATUS[0]}"
zip -j "logs/test-broadcast-latest.zip" "logs/test-broadcast-$ts.log" >/dev/null

http_log="logs/test-http-$ts.log"
br_log="logs/test-broadcast-$ts.log"

field() { grep -m1 "$1" "$2" | sed 's/^ *//'; }

http_files="$(field 'Test Files' "$http_log")"
http_tests="$(field '^ *Tests' "$http_log")"
http_duration="$(field '^ *Duration' "$http_log")"

br_files="$(field 'Test Files' "$br_log")"
br_tests="$(field '^ *Tests' "$br_log")"
br_duration="$(field '^ *Duration' "$br_log")"

# –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–∏–∞–ª–æ–≥–∞
req1="$(grep -i -c 'passes admin command to dialog when handler is missing' "$http_log" "$br_log" 2>/dev/null || true)"
req2="$(grep -i -c 'continues dialog when admin command handler returns undefined' "$http_log" "$br_log" 2>/dev/null || true)"
req3="$(grep -i -c 'continues dialog when broadcast command access is denied' "$http_log" "$br_log" 2>/dev/null || true)"
req4="$(grep -i -c 'routes dialog after broadcast command is followed by admin status' "$http_log" "$br_log" 2>/dev/null || true)"
req5="$(grep -i -c 'sends broadcast via telegram command and confirms delivery' "$http_log" "$br_log" 2>/dev/null || true)"
req6="$(grep -i -c 'broadcast sent via telegram command' "$http_log" "$br_log" 2>/dev/null || true)"

ok_http="$([ "$http_exit" = "0" ] && echo OK || echo FAIL)"
ok_br="$([ "$br_exit" = "0" ] && echo OK || echo FAIL)"

all_reqs="$([ "$req1" -gt 0 ] && [ "$req2" -gt 0 ] && [ "$req3" -gt 0 ] && [ "$req4" -gt 0 ] && [ "$req5" -gt 0 ] && [ "$req6" -gt 0 ] && echo OK || echo WARN)"

report="reports/REPORT-Task6-unblock-dialog-from-broadcast-$ts.md"
{
  echo "# 6. üì£ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏ ‚Äî –æ—Ç—á—ë—Ç –ø—Ä–æ–≥–æ–Ω–∞"
  echo
  echo "- –î–∞—Ç–∞: $(date '+%d.%m.%Y, %H:%M')"
  echo "- Worker: $WORKER_BASE_URL"
  echo
  echo "## HTTP suite ($ok_http)"
  echo "- $http_files"
  echo "- $http_tests"
  echo "- $http_duration"
  echo
  echo "## Broadcast suite ($ok_br)"
  echo "- $br_files"
  echo "- $br_tests"
  echo "- $br_duration"
  echo
  echo "## –ü—Ä–∏–∑–Ω–∞–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–∏–∞–ª–æ–≥–∞ (–¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å)"
  echo "- passes admin command to dialog when handler is missing: $req1"
  echo "- continues dialog when admin command handler returns undefined: $req2"
  echo "- continues dialog when broadcast command access is denied: $req3"
  echo "- routes dialog after broadcast command is followed by admin status: $req4"
  echo "- sends broadcast via telegram command and confirms delivery: $req5"
  echo "- broadcast sent via telegram command: $req6"
  echo
  echo "## –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã"
  echo "- logs/test-http-latest.zip"
  echo "- logs/test-broadcast-latest.zip"
  echo "- $http_log"
  echo "- $br_log"
  echo
  if [ "$ok_http" = "OK" ] && [ "$ok_br" = "OK" ] && [ "$all_reqs" = "OK" ]; then
    echo "## –ò—Ç–æ–≥"
    echo "‚úÖ –î–∏–∞–ª–æ–≥ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏: —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ, –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç."
  else
    echo "## –ò—Ç–æ–≥"
    echo "‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–µ—Ç–∞–ª–∏: ok_http=$ok_http, ok_broadcast=$ok_br, key_signals=$all_reqs. –ï—Å–ª–∏ –µ—Å—Ç—å WARN/FAIL ‚Äî –æ—Ç–∫—Ä—ã—Ç—å –ª–æ–≥–∏ –∏ —Å–≤–µ—Ä–∏—Ç—å –∫–µ–π—Å—ã."
  fi
} > "$report"

echo "$report"
tail -n +1 "$report"
```

## –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∑—ã–≤
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è–º–∏: –ø—Ä–∏ –æ—à–∏–±–∫–µ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–≤–æ–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram (—Å–º. [`memory-bank/references/telegram-broadcast.md`](../references/telegram-broadcast.md)).

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
- –û—Ü–µ–Ω–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—â–∏—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π) –ø–æ—Å–ª–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
